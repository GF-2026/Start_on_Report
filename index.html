<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reporte Preventivo</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">AV</div>
      <div>
        <h1>REPORTE DE PREVENTIVO</h1>
        <div class="muted">Llena el formulario, firma y presiona "Guardar registro".</div>
      </div>
    </header>

    <form id="reportForm" class="card">
      <!-- DATOS GENERALES -->
      <div class="section-header">
        <strong>1 – Datos de cliente</strong>
        <div class="muted">Campos obligatorios *</div>

      </div>
      <div class="grid">
        <div><label>Report: *</label><input type="text" id="report" value="Mantenimiento preventivo" required></div>
        <div><label>OT: *</label><input type="text" id="OT" required></div>
        <div><label>Fecha y Hora: *</label><input type="datetime-local" id="datetime" required></div>
        <div><label>Compañía:</label><input type="text" id="company"></div>
        <div><label>Ingeniero a cargo:</label><input type="text" id="engineer"></div>
        <div><label>Teléfono:</label><input type="text" id="phone"></div>
        <div><label>Ciudad:</label><input type="text" id="city"></div>
      </div>

      <hr>

      <!-- EQUIPO -->
      <div class="section-header"><strong>2 – Datos del equipo</strong></div>
      <div class="grid">
        <div><label>Descripción:</label><input type="text" id="description"></div>
        <div><label>Marca:</label><input type="text" id="brand"></div>
        <div><label>Modelo:</label><input type="text" id="model"></div>
        <div><label>Serie:</label><input type="text" id="serial"></div>
        <div><label>Número de control:</label><input type="text" id="controlnum"></div>
        <div><label>Estado Operativo:</label><input type="text" id="status"></div>
      </div>

      <hr>

      <!-- AMBIENTE -->
      <div class="section-header"><strong>3 – Condiciones ambientales</strong></div>
      <div class="grid">
        <div class="fullwidth"><label>Ubicación</label><input type="text" id="ubication"></div>
        <div><label>Temperatura: (°C)</label><input type="number" step="0.1" id="temperature"></div>
        <div><label>Humedad: (%)</label><input type="number" step="0.1" id="humidity"></div>
      </div>

      <hr>

      <!-- CHECKLIST -->
      <div class="section-header"><strong>4 – Checklist</strong></div>
      <div class="grid checkboxes">
        <label><input type="checkbox" id="shock_free">Esta libre de golpes</label>
        <label><input type="checkbox" id="specs_available">Hay especificaciones disponibles</label>
        <label><input type="checkbox" id="manuals">Se tienen manuales y diagramas</label>
        <label><input type="checkbox" id="refrigerant">Tiene carga de refrigerante</label>
        <label><input type="checkbox" id="voltage_plate">El voltaje coincide con la placa</label>
        <label><input type="checkbox" id="supplies_installed">Suministros instalados</label>
      </div>

      <hr>

      <!-- MEDICIONES -->
      <div class="section-header"><strong>5 – Mediciones eléctricas</strong></div>
      <div class="grid">
        <div><label>Presión LS:</label><input type="number" step="0.01" id="static_ls"></div>
        <div><label>Presión HS:</label><input type="number" step="0.01" id="static_hs"></div>
        <div><label>Resistencia: (Ω)</label><input type="number" step="0.001" id="resistance"></div>
        <div><label>Compresor T1–T2 (V)</label><input type="number" step="0.1" id="t1_t2"></div>
        <div><label>Compresor T1–T3 (V)</label><input type="number" step="0.1" id="t1_t3"></div>
        <div><label>Compresor T2–T3 (V)</label><input type="number" step="0.1" id="t2_t3"></div>
        <div><label>To ground (V)</label><input type="number" step="0.01" id="to_ground"></div>
      </div>

      <hr>

      <!-- OBSERVACIONES -->
      <div class="section-header"><strong>6 – Observaciones</strong></div>
      <textarea id="notes"></textarea>

      <hr>

      <!-- FIRMA -->
      <div class="section-header"><strong>7 – Firma</strong></div>
      <button type="button" id="openSignature">Abrir área de firma</button>
      <canvas id="signaturePreview" width="300" height="150"></canvas>

      <div class="form-actions">
        <button type="button" id="saveBtn">Guardar registro</button>
        <button type="button" id="clearBtn" class="secondary">Limpiar formulario</button>
      </div>
    </form>

    <!-- TABLA -->
    <div class="card">
      <div class="section-header">
        <strong>Registros capturados</strong>
        <div class="actions">
          <button id="exportBtn">Exportar a Excel</button>
          <button id="downloadCsvBtn" class="secondary">Exportar CSV</button>
          <button id="deleteAllBtn" class="secondary">Borrar registros</button>
        </div>
      </div>
      <div class="table-wrap">
        <table id="recordsTable">
          <thead><tr id="tableHead"></tr></thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- MODAL FIRMA -->
  <div id="signatureModal">
    <div id="signatureBox">
      <h3>Firma manuscrita</h3>
      <canvas id="signatureCanvas" width="300" height="150"></canvas>
      <div class="signature-actions">
        <button id="clearSignature">Limpiar</button>
        <button id="saveSignature">Guardar firma</button>
        <button id="closeSignature" class="secondary">Cerrar</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
