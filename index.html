<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REPORTE DE ARRANQUE</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>

<body>
    <div class="container">
        <header>
            <img id="logo" src="LOGO.png" alt="FIXSER">
            <div>
                <h1>REPORTE DE ARRANQUE</h1>
                <div class="muted">Llena el formulario, firma y presiona "Guardar registro".</div>
            </div>
        </header>

        <form id="reportForm" class="card">
            <!-- 1 – Datos de cliente -->
            <div class="section-header"><strong>1 – Datos de cliente</strong>
                <div class="muted">Campos obligatorios *</div>
            </div>
            <div class="grid">
                <div><label>OT: *</label><input type="text" id="OT" required></div>
                <div><label>Fecha y Hora:*</label><input type="datetime-local" id="datetime" required></div>
                <div><label>Compañía:*</label><input type="text" id="company" required></div>
                <div><label>Ingeniero a cargo:*</label><input type="text" id="engineer" required></div>
                <div><label>Teléfono:*</label><input type="text" id="phone"></div>
                <div><label>Ciudad:*</label><input type="text" id="city" required></div>
            </div>

            <!-- 2 – Datos del equipo -->
            <hr>
            <div class="section-header"><strong>2 – Datos del equipo</strong></div>
            <div class="grid">
                <div><label>Descripción:*</label><input type="text" id="description"  required></div>
                <div><label>Marca:*</label><input type="text" id="brand" required></div>
                <div><label>Modelo:*</label><input type="text" id="model" required></div>
                <div><label>Serie:*</label><input type="text" id="serial" required></div>
                <div><label>Número de control:*</label><input type="text" id="controlnum"></div>
                <div><label>¿Está disponible el equipo?*</label><input type="text" id="status_test" required></div>
                
            </div>

            <!-- 3 – Condiciones ambientales -->
            <hr>
            <div class="section-header"><strong>3 – Condiciones ambientales</strong></div>
            <div class="grid">
                 <div><label>Ubicación en planta:*</label><input type="text" id="ubication" required></div>
                <div><label>Temperatura (°C):</label><input type="text"   id="temperature"></div>
                <div><label>Humedad (%):</label><input type="text"   id="humidity"></div>

            </div>
                        <hr>
            <div class="section-header"><strong>4 – Chequeo inicial</strong></div>
            <div>Voltaje General: (V)</div>
            <div class="grid">          
                <div><label>L1*<input type="text"   id="voltage_L1" required></label></div>
                <div><label>L2*<input type="text"   id="voltage_L2" required></label></div>
                 <div><label>L3*<input type="text"  id="voltage_L3" required></label></div>
                 <div><label>Voltaje a neutro (V):</label></div>
                <div><label><input type="text" id="voltage_fase_to_neutral"></label></div>
            </div>
            <div class="grid checkboxes">
                <label><input type="checkbox" id="marking_ok">Se marcó futuro espacio de equipo</label>
                <label><input type="checkbox" id="voltage_plate_ok">El voltaje coincide con la placa</label>
                <label><input type="checkbox" id="shock_free_ok">Está libre de golpes</label>
                <label><input type="checkbox" id="pallets_ok">Se deja espacio para tarimas</label>
                <label><input type="checkbox" id="have_space_unpack_ok">Se deja espacio para desempacar</label>
                <label><input type="checkbox" id="supplies_installed_ok">Suministros instalados</label>
                <label><input type="checkbox" id="specs_available_ok">Hay especificaciones disponibles</label>
                <label><input type="checkbox" id="has_refrigerant_ok">Tiene carga de refrigerante</label>
                <label><input type="checkbox" id="manuals_ok">Se tienen manuales y diagramas</label>
                <label><input type="checkbox" id="overloads_config_ok">Configuración de overloads OK</label>
            </div>
            <!-- 5 – Mediciones -->
            <hr>
            <div class="section-header"><strong>5 – Mediciones</strong></div>
            <div class="grid">
                <div class="mediciones">
                    <div>
                        <label>Presión Estática LS:*</label><br>
                        <input type="text"  id="static_ls" required>
                        <label>Psi</label><br>
                    </div>

                    <div>
                        <label>Presión Estática HS:*</label><br>
                        <input type="text"  id="static_hs" required>
                        <label>Psi</label><br>
                    </div>

                    <div>
                        <label>Resistencia compresor HS (Ω):</label><br>
                        <div><label>T1-T2*<input type="text"   id="resistance_hs_rs" required></label></div>
                        <div><label>T1-T3*<input type="text"   id="resistance_hs_rt" required></label></div>
                        <div><label>T2-T3*<input type="text"   id="resistance_hs_st" required></label></div>
                    </div>
                    <div>
                        <label>A tierra:*</label><br>
                        <input type="text" id="resistance_hs_to_ground" required>
                    </div>

                    <div>
                        <label>Resistencia compresor LS (Ω):</label><br>
                        <div><label>T1-T2*<input type="text"   id="resistance_ls_rs" required></label></div>
                        <div><label>T1-T3*<input type="text"   id="resistance_ls_rt" required></label></div>
                        <div><label>T2-T3*<input type="text"   id="resistance_ls_st" required></label></div>
                    </div>
                    
                    <div>
                        <label>A tierra:*</label><br>
                        <input type="text" id="resistance_ls_to_ground" required>
                    </div>

                    <div>
                        <label>Resistencia circulador (Ω):*</label><br>
                        <input type="text"   id="resistance_circ_rs" required>
                        <input type="text"   id="resistance_circ_rt">
                        <input type="text"   id="resistance_circ_st">
                    </div>
                        
                    <div>
                        <label>A tierra:*</label><br>
                        <input type="text" id="resistance_circs_to_ground" required>
                    </div>

                    <div>
                        <label>Resistencia heater (Ω):</label><br>
                        <div><label>H1-H2*<input type="text"   id="resistance_heat_rs" required></label></div>
                        <div><label>H1-H3*<input type="text"   id="resistance_heat_rt" required></label></div>
                        <div><label>H2-H3*<input type="text"   id="resistance_heat_st" required></label></div> 
                    </div>
                        
                    <div>
                        <label>A tierra:*</label><br>
                        <input type="text" id="resistance_heats_to_ground" required>
                    </div>

                    <div>
                        <label>Resistencia humidificador (Ω):</label><br>
                        <input type="text"   id="resistance_hum_rs">
                        <input type="text"   id="resistance_hum_rt">
                        <input type="text"   id="resistance_hum_st">
                    </div>
                        
                    <div>
                        <label>A tierra:</label><br>
                        <input type="text" id="resistance_hums_to_ground">
                    </div>

                    <div>
                        <label>Voltaje compresor HS (V):</label><br>
                        <input type="text" id="voltaje_hs_r">
                        <input type="text" id="voltaje_hs_s">
                        <input type="text" id="voltaje_hs_t">
                    </div>

                    <div>
                        <label>Voltaje compresor LS (V):</label><br>
                        <input type="text" id="voltaje_ls_r">
                        <input type="text" id="voltaje_ls_s">
                        <input type="text" id="voltaje_ls_t">
                    </div>

                    <div>
                        <label>Amperajes compresor HS (A):</label><br>               
                        <div><label>T1*<input type="text"   id="current_hs_r" required></label></div>
                        <div><label>T2*<input type="text"   id="current_hs_s" required></label></div>
                        <div><label>T3*<input type="text"   id="current_hs_t" required></label></div>
                    </div>

                    <div>
                        <label>Amperajes compresor LS (A):</label><br>
                        <div><label>T1*<input type="text"   id="current_ls_r" required></label></div>
                        <div><label>T2*<input type="text"   id="current_ls_s" required></label></div>
                        <div><label>T3*<input type="text"   id="current_ls_t" required></label></div>
                    </div>

                    <div>
                        <label>Amperajes circuladores (A):</label><br>
                        <input type="text" id="current_circ_r">
                        <input type="text" id="current_circ_s">
                        <input type="text" id="current_circ_t">
                    </div>
                    
                    <div>
                        <label>Amperajes de Condensador (A):</label><br>
                        <input type="text" id="current_cond_fan_r">
                        <input type="text" id="current_cond_fan_s">
                        <input type="text" id="current_cond_fan_t">
                    </div>

                    <div>
                        <label>Amperajes heater (A):</label><br>
                        <input type="text" id="current_heat_r">
                        <input type="text" id="current_heat_s">
                        <input type="text" id="current_heat_t">
                    </div>

                    <div>
                        <label>Amperajes de head fan (A):</label><br>
                        <input type="text" id="current_headfan_r">
                        <input type="text" id="current_headfan_s">
                        <input type="text" id="current_headfan_t">
                    </div>
                    

                    <div>
                        <label>Amperajes humidificador (A):</label><br>
                        <input type="text" id="current_hum_r">
                        <input type="text" id="current_hum_s">
                        <input type="text" id="current_hum_t">
                    </div>

                    <div>
                        <label>Presiones compresor HS:*</label><br>
                        <input type="text" id="pressures_hs_suction" required>
                        <input type="text" id="pressures_hs_disch" required>
                        <label>Psi</label><br>
                    </div>

                    <div>
                        <label>Presiones compresor LS:*</label><br>
                        <input type="text" id="pressures_ls_suction" required>
                        <input type="text" id="pressures_ls_disch" required>
                        <label>Psi</label><br>
                    </div>
                </div>
            </div>

            <!-- 6 – Chequeo eléctrico -->
            <hr>
            <div class="section-header"><strong>6 – Chequeo eléctrico</strong></div>
            <div class="grid checkboxes">
                <label><input type="checkbox" id="main_switch_ok">Switch principal, hardware y cables correctos OK</label>
                <label><input type="checkbox" id="highvolt_cables_ok">Cables de alto voltaje OK</label>
                <label><input type="checkbox" id="switch_covers_ok">Cubiertas de presostatos OK</label>
                <label><input type="checkbox" id="tighting_ok">Conexiones reapretadas OK</label>
                <label><input type="checkbox" id="headfan_ok">Revisión de headfans OK</label>
                <label><input type="checkbox" id="balance_ok">Carga balanceada OK</label>
                <label><input type="checkbox" id="fuses_ok">Fusibles correctos OK</label>
                <label><input type="checkbox" id="faseado_ok">Faseado correcto OK</label>
                <label><input type="checkbox" id="crankcase_ok">Calentador de cárter OK</label>
                <label><input type="checkbox" id="grounded_ok">Tierra física OK</label>
            </div>

            <!-- 7 – Chequeo en refrigeración -->
            <hr>
            <div class="section-header"><strong>7 – Chequeo en refrigeración</strong></div>
            <div class="grid checkboxes">
                <label><input type="checkbox" id="fans_ok">Ventiladores OK</label>
                <label><input type="checkbox" id="coils_ok">Serpentines OK</label>
                <label><input type="checkbox" id="armafles_ok">Armaflex OK</label>
                <label><input type="checkbox" id="injection_valve_ok">Válvula de inyección OK</label>
                <label><input type="checkbox" id="level_oi_ok">Nivel de aceite correcto</label>
                <label><input type="checkbox" id="protect_lowleveloil_ok">Bajo Nivel de aceite Protección</label>
                <label><input type="checkbox" id="sights_ok">Mirillas OK</label>
                <label><input type="checkbox" id="acid_ok">Prueba de acidez</label>
                <label><input type="checkbox" id="hilow_protect_ok">Chequeo Hi/Low</label>
                <label><input type="checkbox" id="rotalocks_ok">Capuchones de rotalocks</label>
                <label><input type="checkbox" id="capillaries_ok">Capilares OK</label>
                <label><input type="checkbox" id="frosty_ok">Escarche de succión</label>
                <label><input type="checkbox" id="channels_ok">Canales OK</label>
                <label><input type="checkbox" id="overcool_overtemp_ok">Over temp y overcool Ok</label>
                <label><input type="checkbox" id="controller_calibrated_ok">calibración OK</label>
                <label><input type="checkbox" id="sensors_ok">Sensores OK</label>
                <label><input type="checkbox" id="static_press_ok">Presión estática OK</label>
                <label><input type="checkbox" id="temp_water_in_cond_ok">Temp. entrada a Cond. OK</label>
                <label><input type="checkbox" id="temp_water_out_cond_ok">Temp. salida a Cond. OK</label>
                <label><input type="checkbox" id="press_water_in_cond_ok">Press. entrada a Cond. OK</label>   
                <label><input type="checkbox" id="press_water_out_cond_ok">Press. salida a Cond. OK</label>
                <label><input type="checkbox" id="temp_disch_hs_ok">Temp. Descarga HS OK</label>
                <label><input type="checkbox" id="temp_disch_ls_ok">Temp. Descarga LS OK</label>                
                <label><input type="checkbox" id="bypass_cal_ok">Cal. Bypass OK</label>
            </div>
            
            
            </div>
            

            <!-- 8 – Pruebas -->
            <hr>
            <div class="section-header"><strong>8 – Pruebas</strong></div>
            <div class="grid">
                <div><label>Temp. ambiente (°C):</label><input type="text" id="hum_from"></div>
                <div><label>Punto máximo -10 (°C):</label><input type="text" id="heat_target"></div>
                <label><input type="checkbox" id="heat_test_ok">Prueba de calentamiento (soak 30 min)</label>
                <div><label>Punto máximo -10 (°C):</label><input type="text" id="temp_hig"></div>
                <div><label>Punto minimo +10 (°C):</label><input type="text" id="temp_low"></div>
                <label><input type="checkbox" id="cold_test_ok">Prueba de enfriamiento (soak 30 min)</label>
                <div><label>Presión máxima (Psi):</label><input type="text" id="pulldown"></div>
                <label><input type="checkbox">Setear a valores propios para la humedad</label>                
                <div><label>Humedad baja (20 %HR):</label><input type="text" id="hum_low"></div>
                <div><label>Humedad alta (80 %HR):</label><input type="text" id="hum_hig"></div>
                <label><input type="checkbox" id="hum_test_ok">Prueba de humedad (soak 30 min c/u)</label>
            </div>
<hr>
<div class="section-header"><strong>9 – Salud del equipo</strong></div>
<div class="custom-select">
<div>
    <label>¿Qué Semáforo de salud tiene el sistema de Refrigeración?</label><br> 
    <div class="custom-select"> 
        <select id="estado_ref" class="select-styled">
            <option value="" disabled selected>Seleccione...</option>
            <option value="rojo">Rojo</option>
            <option value="amarillo">Amarillo</option>
            <option value="verde">Verde</option>
        </select>
    </div>
</div>

<div>
    <label>¿Qué Semáforo de salud tiene el sistema de Calefacción?</label><br> 
    <div class="custom-select"> 
        <select id="estado_heat" class="select-styled">
            <option value="" disabled selected>Seleccione...</option>
            <option value="rojo">Rojo</option>
            <option value="amarillo">Amarillo</option>
            <option value="verde">Verde</option>
        </select>
    </div>
</div>

<div>
    <label>¿Qué Semáforo de salud tiene el sistema Eléctrico?</label><br> 
    <div class="custom-select"> 
        <select id="estado_elec" class="select-styled">
            <option value="" disabled selected>Seleccione...</option>
            <option value="rojo">Rojo</option>
            <option value="amarillo">Amarillo</option>
            <option value="verde">Verde</option>
        </select>
    </div>
</div>
        </div>
</div>
<!-- 9 – Observaciones -->
<!-- Pregunta: ¿Cuándo se sugiere el siguiente servicio? -->
<br>
<hr>
<div class="section-header"><strong>10 – ¿Cuándo se sugiere el siguiente servicio?</strong></div>
<div class="custom-select"> 
  <select class="select-styled" id="resultado_servicio">
    <option value="" disabled selected>Seleccione...</option>
    <option value="3 meses">En 3 meses</option>
    <option value="6 meses">En 6 meses</option>
    <option value="1 año">En 1 año</option>
  </select>
</div>
<hr>
            <div class="section-header"><label><strong>11 - Actividades realizadas:*<br></strong></label></div>
            <div class="fullwidth"><textarea id="act_work" placeholder = "FAVOR DE APOYARSE CON LAS SIGUIENTES PREGUNTAS PARA QUE EL REPORTE QUEDE CON INFORMACIÓN MÁS COMPLETA:
- ¿Cuál fue el primer día de inicio y cuáles las actividades por día?
- ¿Se tuvieron los suministros instalados al iniciar el arranque o instalación del equipo?
- ¿Tuve algún contratiempo en el proceso?                                       
- ¿Solicité información nueva sobre el equipo?
- ¿Correspondía la información con el equipo?
- ¿Realicé anotaciones extra?
- ¿Efectué alguna prueba con perfil del cliente?
- ¿Cómo dejo el equipo?"></textarea></label></div><br>

            <hr>
            <div class="section-header"><strong>12 – Notas del Cliente</strong></div>
            <textarea id="notes_Cus"></textarea>

            <!-- 10 – Firma de especialista -->
            <hr>
            <div class="section-header"><strong>13 – Firma de especialista</strong></div>
            <div><label>Nombre de Especialista</label><input type="text" id="name_esp"></div>
            <button type="button" id="openSignatureEsp">Firma de Especialista</button>
            <canvas id="signaturePreviewEsp" width="300" height="150"></canvas>

            <!-- 11 – Firma de cliente -->
            <hr>
            <div class="section-header"><strong>14 – Firma de cliente</strong></div>
            <div><label>Nombre de Cliente</label><input type="text" id="name_cus"></div>
            <button type="button" id="openSignatureCus">Firma de Cliente</button>
            <canvas id="signaturePreviewCus" width="300" height="150" required></canvas>
            <hr>
            <!-- Acciones -->
            <div class="form-actions">
                <div>
                <button type="button" id="saveBtn">A) Guardar registro</button>
                 </div>
                <div>
                <button type="button" id="exportBtn">B) Exportar a Excel</button>
                 </div>    
                <div>
                <button type="button" id="sendEmailBtn">C) Enviar reporte por correo</button>
                 </div>
                <div>
                <button type="button" id="deleteAllBtn" class="secondary">Borrar registros</button>

                <div>
                <button type="button" id="clearBtn" class="secondary">Limpiar formulario</button>
                 </div>
            </div>
        </form>

        <!-- Tabla de registros -->
        <div class="card">
            <div class="section-header"><strong>Registros capturados</strong></div>
            <div class="table-wrap">
                <table id="recordsTable">
                    <thead>
                        <tr id="tableHead"></tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal de firma -->
    <div id="signatureModal">
        <div id="signatureBox">
            <h3>Firma manuscrita</h3>
            <canvas id="signatureCanvas" width="300" height="150"></canvas>
            <div class="signature-actions">
                <button id="clearSignature">Limpiar</button>
                <button id="saveSignature">Guardar firma</button>
                <button id="closeSignature" class="secondary">Cerrar</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>
